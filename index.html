<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Insurance Form</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #4CAF50;
      color: white;
      text-align: center;
      padding: 15px 0;
    }

    .container {
      width: 80%;
      margin: 20px auto;
      background-color: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }

    .form-section {
      margin-bottom: 30px;
    }

    .form-section h3 {
      color: #333;
      border-bottom: 2px solid #ddd;
      padding-bottom: 10px;
      margin-bottom: 15px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      font-size: 14px;
      font-weight: bold;
      color: #555;
    }

    .form-group input,
    .form-group select,
    .form-group textarea,
    .form-group button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
      padding: 15px;
      width: 100%;
      margin-top: 10px;
    }

    button:hover {
      background-color: #45a049;
    }

    .extra-actions {
      text-align: center;
      margin-top: 20px;
    }

    .extra-actions input {
      width: auto;
      display: inline-block;
    }

    .note {
      font-size: 14px;
      color: #888;
      text-align: center;
    }
  </style>
</head>
<script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>

<body>

  <header>
    <h1>Health Insurance Form</h1>
  </header>

  <div class="container">
    <h2>Submit Your Details</h2>
    <form id="insuranceForm">


      <!-- Policy details -->
      <div class="form-section">
        <h3>Policy Details</h3>
        <div class="form-group">
          <label for="policyIdentificationNumber">Policy Identification Number</label>
          <input type="text" id="policyIdentificationNumber" name="policyIdentificationNumber"
            placeholder="Enter your policy identification number" required />
        </div>
        <div class="form-group">
          <label for="action">Action</label>
          <input type="text" id="action" name="action" placeholder="Enter your action" required />
        </div>
        <div class="form-group">
          <label for="actionEffectiveDate">Action Effective Date</label>
          <input type="date" id="actionEffectiveDate" name="actionEffectiveDate" required />
        </div>
      </div>

      <!-- Personal Details Section -->
      <div class="form-section">
        <h3>Personal Details</h3>

        <div class="form-group">
          <label for="firstName">First Name</label>
          <input type="text" id="firstName" name="firstName" placeholder="Enter your first name" required />
        </div>

        <div class="form-group">
          <label for="middleName">Middle Name</label>
          <input type="text" id="middleName" name="middleName" placeholder="Enter your middle name" />
        </div>

        <div class="form-group">
          <label for="lastName">Last Name</label>
          <input type="text" id="lastName" name="lastName" placeholder="Enter your last name" required />
        </div>

        <div class="form-group">
          <label for="gender">Gender</label>
          <select id="gender" name="gender" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label for="title">Title</label>
          <select id="title" name="title">
            <option value="">Select Title</option>
            <option value="Mr.">Mr.</option>
            <option value="Mrs.">Mrs.</option>
            <option value="Dr.">Dr.</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label for="dateOfBirth">Date of Birth</label>
          <input type="date" id="dateOfBirth" name="dateOfBirth" required />
        </div>

        <div class="form-group">
          <label for="age">Age</label>
          <input type="number" id="age" name="age" placeholder="Enter your age" required />
        </div>

        <div class="form-group">
          <label for="dateOfMarriage">Date of Marriage (if applicable)</label>
          <input type="date" id="dateOfMarriage" name="dateOfMarriage" />
        </div>

        <div class="form-group">
          <label for="nationality">Nationality</label>
          <input type="text" id="nationality" name="nationality" placeholder="Enter your nationality" required />
        </div>

        <div class="form-group">
          <label for="occupation">Occupation</label>
          <input type="text" id="occupation" name="occupation" placeholder="Enter your occupation" required />
        </div>

        <div class="form-group">
          <label for="bmi">BMI (Body Mass Index)</label>
          <input type="number" id="bmi" name="bmi" placeholder="Enter your BMI" step="0.1" required />
        </div>

        <div class="form-group">
          <label for="weight">Weight (kg)</label>
          <input type="number" id="weight" name="weight" placeholder="Enter your weight" step="0.1" />
        </div>

        <div class="form-group">
          <label for="height">Height (cm)</label>
          <input type="number" id="height" name="height" placeholder="Enter your height" step="0.1" />
        </div>
      </div>

      <!-- Contact Details Section -->
      <div class="form-section">
        <h3>Contact Details</h3>

        <div class="form-group">
          <label for="mobileNumber">Mobile Number</label>
          <input type="tel" id="mobileNumber" name="mobileNumber" placeholder="Enter your mobile number" required />
        </div>

        <div class="form-group">
          <label for="alternateNumber">Alternate Number</label>
          <input type="tel" id="alternateNumber" name="alternateNumber" placeholder="Enter your alternate number" />
        </div>

        <div class="form-group">
          <label for="emergencyContactNumber">Emergency Contact Number</label>
          <input type="tel" id="emergencyContactNumber" name="emergencyContactNumber"
            placeholder="Enter emergency contact number" required />
        </div>

        <div class="form-group">
          <label for="stdCode">STD Code</label>
          <input type="text" id="stdCode" name="stdCode" placeholder="Enter STD code" required />
        </div>

        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" name="email" placeholder="Enter your email address" required />
        </div>

        <div class="form-group">
          <select id="isMobileSameAsWhatsapp" name="isMobileSameAsWhatsapp" required>
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>
      </div>

      <!-- Address Details Section -->
      <div class="form-section">
        <h3>Address Details</h3>

        <div class="form-group">
          <label for="addressLine1">Address Line 1</label>
          <input type="text" id="addressLine1" name="addressLine1" placeholder="Enter address line 1" required />
        </div>

        <div class="form-group">
          <label for="addressLine2">Address Line 2</label>
          <input type="text" id="addressLine2" name="addressLine2" placeholder="Enter address line 2" />
        </div>

        <div class="form-group">
          <label for="addressLine3">Address Line 3</label>
          <input type="text" id="addressLine3" name="addressLine3" placeholder="Enter address line 3" />
        </div>

        <div class="form-group">
          <label for="pinCode">Pin Code</label>
          <input type="text" id="pinCode" name="pinCode" placeholder="Enter pin code" required />
        </div>

        <div class="form-group">
          <label for="internationalAddress">International Address</label>
          <textarea id="internationalAddress" name="internationalAddress"
            placeholder="Enter international address"></textarea>
        </div>

        <div class="form-group">
          <label for="internationalContact">International Contact</label>
          <input type="tel" id="internationalContact" name="internationalContact"
            placeholder="Enter international contact number" />
        </div>

        <div class="form-group">
          <label for="mailingSameAsPrimary">Mailing Same As Primary Address</label>
          <select id="mailingSameAsPrimary" name="mailingSameAsPrimary">
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>
      </div>

      <!-- Identification Numbers Section -->
      <div class="form-section">
        <h3>Identification Numbers</h3>

        <div class="form-group">
          <label for="aadharCardNo">Aadhar Card No</label>
          <input type="text" id="aadharCardNo" name="aadharCardNo" placeholder="Enter Aadhar Card No" />
        </div>

        <div class="form-group">
          <label for="panCardNo">PAN Card No</label>
          <input type="text" id="panCardNo" name="panCardNo" placeholder="Enter PAN Card No" />
        </div>

        <div class="form-group">
          <label for="passport">Passport</label>
          <input type="text" id="passport" name="passport" placeholder="Enter Passport No" />
        </div>

        <div class="form-group">
          <label for="vvoterIdCard">Voter ID Card</label>
          <input type="text" id="voterIdCard" name="voterIdCard" placeholder="Enter Voter ID" />
        </div>

        <div class="form-group">
          <label for="drivingLicense">Driving License</label>
          <input type="text" id="drivingLicense" name="drivingLicense" placeholder="Enter Driving License No" />
        </div>

        <div class="form-group">
          <label for="ckycNumber">CKYC Number</label>
          <input type="text" id="ckycNumber" name="ckycNumber" placeholder="Enter CKYC No" />
        </div>
      </div>

      <!-- Other Flags Section -->
      <div class="form-section">
        <h3>Other Flags</h3>

        <div class="form-group">
          <label for="priorityCustomer">Priority Customer</label>
          <select id="priorityCustomer" name="priorityCustomer">
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>

        <div class="form-group">
          <label for="sensitiveCustomer">Sensitive Customer</label>
          <select id="sensitiveCustomer" name="sensitiveCustomer">
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>

        <div class="form-group">
          <label for="policyHolderAlsoMember">Policy Holder Also Member</label>
          <select id="policyHolderAlsoMember" name="policyHolderAlsoMember">
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>

        <div class="form-group">
          <label for="politicallyExposedPerson">Politically Exposed Person</label>
          <select id="politicallyExposedPerson" name="politicallyExposedPerson">
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>

        <div class="form-group">
          <label for="form60">Form 60</label>
          <select id="form60" name="form60">
            <option value="">Select Option</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>

        <div class="form-group">
          <label for="priorityCustomerRemarks">Priority Customer Remarks</label>
          <textarea id="priorityCustomerRemarks" name="priorityCustomerRemarks"
            placeholder="Enter remarks for priority customer"></textarea>
        </div>

        <div class="form-group">
          <label for="educationalQualification">Educational Qualification</label>
          <input type="text" id="educationalQualification" name="educationalQualification"
            placeholder="Enter educational qualification" />
        </div>
      </div>



      <!-- Insurance Plan Details Section -->
      <div class="form-section">
        <h3>Insurance Plan Details</h3>

        <div class="form-group">
          <label for="annualGrossIncome">Annual Gross Income</label>
          <input type="text" id="annualGrossIncome" name="annualGrossIncome" placeholder="Enter annual gross income" />
        </div>

        <div class="form-group">
          <label for="applicableSumInsured">Applicable Sum Insured</label>
          <input type="text" id="applicableSumInsured" name="applicableSumInsured"
            placeholder="Enter applicable sum insured" />
        </div>

        <div class="form-group">
          <label for="relationship">Relationship</label>
          <input type="text" id="relationship" name="relationship" placeholder="Enter relationship" />
        </div>

        <div class="form-group">
          <label for="memberCode">Member Code</label>
          <input type="text" id="memberCode" name="memberCode" placeholder="Enter member code" />
        </div>
      </div>

      <!-- Nominee Details Section -->
      <div class="form-section">
        <h3>Nominee Details</h3>

        <div class="form-group">
          <label for="nomineeName">Nominee Name</label>
          <input type="text" id="nomineeName" name="nomineeName" placeholder="Enter nominee name" />
        </div>

        <div class="form-group">
          <label for="nomineeDateOfBirth">Nominee Date of Birth</label>
          <input type="date" id="nomineeDateOfBirth" name="nomineeDateOfBirth" />
        </div>

        <div class="form-group">
          <label for="nomineeAge">Nominee Age</label>
          <input type="number" id="nomineeAge" name="nomineeAge" placeholder="Enter nominee age" />
        </div>

        <div class="form-group">
          <label for="nomineeRelationshipWithProposer">Nominee Relationship With Proposer</label>
          <input type="text" id="nomineeRelationshipWithProposer" name="nomineeRelationshipWithProposer"
            placeholder="Enter relationship" />
        </div>

        <div class="form-group">
          <label for="nomineeGender">Nominee Gender</label>
          <select id="nomineeGender" name="nomineeGender">
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label for="nomineeContactNumber">Nominee Contact Number</label>
          <input type="tel" id="nomineeContactNumber" name="nomineeContactNumber"
            placeholder="Enter nominee contact number" />
        </div>

        <div class="form-group">
          <label for="addressOfNominee">Nominee Address</label>
          <textarea id="addressOfNominee" name="addressOfNominee" placeholder="Enter nominee address"></textarea>
        </div>
      </div>
      <!-- Appointee Details Section -->
      <div class="form-section">
        <h3>Appointee Details</h3>

        <div class="form-group">
          <label for="appointeeName">Appointee Name</label>
          <input type="text" id="appointeeName" name="appointeeName" placeholder="Enter appointee name" />
        </div>

        <div class="form-group">
          <label for="relationshipOfAppointeeWithNominee">Appointee Relationship With Nominee</label>
          <input type="text" id="relationshipOfAppointeeWithNominee" name="relationshipOfAppointeeWithNominee"
            placeholder="Enter relationship" />
        </div>

        <div class="form-group">
          <label for="nomineePercentage">Nominee Percentage</label>
          <input type="number" id="nomineePercentage" name="nomineePercentage" placeholder="Enter percentage" />
        </div>
      </div>

      <!-- Bank Details Section -->
      <div class="form-section">
        <h3>Bank Details</h3>

        <div class="form-group">
          <label for="accountHolderName">Account Holder Name</label>
          <input type="text" id="accountHolderName" name="accountHolderName" placeholder="Enter account holder name" />
        </div>

        <div class="form-group">
          <label for="accountNumber">Account Number</label>
          <input type="text" id="accountNumber" name="accountNumber" placeholder="Enter account number" />
        </div>

        <div class="form-group">
          <label for="ifscCode">IFSC Code</label>
          <input type="text" id="ifscCode" name="ifscCode" placeholder="Enter IFSC code" />
        </div>

        <div class="form-group">
          <label for="micrCode">MICR Code</label>
          <input type="text" id="micrCode" name="micrCode" placeholder="Enter MICR code" />
        </div>

        <div class="form-group">
          <label for="bankName">Bank Name</label>
          <input type="text" id="bankName" name="bankName" placeholder="Enter bank name" />
        </div>

        <div class="form-group">
          <label for="bankBranch">Bank Branch</label>
          <input type="text" id="bankBranch" name="bankBranch" placeholder="Enter bank branch" />
        </div>

        <div class="form-group">
          <label for="accountType">Account Type</label>
          <select id="accountType" name="accountType">
            <option value="">Select Account Type</option>
            <option value="Savings">Savings</option>
            <option value="Current">Current</option>
            <option value="Joint">Joint</option>
          </select>
        </div>
      </div>

      <button type="submit">Submit</button>
    </form>

    <div class="extra-actions">
      <button onclick="downloadAll()">Download All Users (Excel)</button>

      <div class="form-group">
        <label for="insuranceId">Enter Insurance ID:</label>
        <input type="text" id="insuranceId" placeholder="e.g., INS-1001" />
        <button onclick="downloadById()">Download by ID</button>
      </div>
    </div>


    <div class="extra-actions">
      <h2>Bulk Upload Insurance Forms</h2>

      <!-- <input type="file" id="fileInput" accept=".xlsx, .xls" />
      <br />
      <div id="fileStatus"></div>
      <button id="uploadBtn">Upload to Server</button> -->
      <!-- <div class="form-group">
        <input type="file" id="excelFile" />
        <button id="uploadBtn">Upload</button>
      </div> -->

<div class="form-group">
  <input type="file" id="excelFile" />
  <button id="uploadBtn">Upload</button>
</div>

<!-- ✅ Success popup div (initially hidden) -->
<div id="uploadSuccess" style="display: none; background-color: #d4edda; color: #155724; padding: 10px; margin-top: 10px; border: 1px solid #c3e6cb; border-radius: 5px;">
  ✅ File uploaded successfully!
</div>


<script>
  document.getElementById('uploadBtn').addEventListener('click', async () => {
    const fileInput = document.getElementById('excelFile');
    const file = fileInput.files[0];

    if (!file) {
      alert('Please select a file!');
      return;
    }

    const formData = new FormData();
    formData.append('file', file);

    try {
      const response = await fetch('http://localhost:8080/bulk-upload', {
        method: 'POST',
        body: formData,
      });

      if (response.ok) {
        // ✅ Show success div
        const popup = document.getElementById('uploadSuccess');
        popup.style.display = 'block';

        // ✅ Optional: Auto-hide after 3 seconds
        setTimeout(() => {
          popup.style.display = 'none';
        }, 3000);
      } else {
        alert('File upload failed!');
      }
    } catch (error) {
      console.error('Upload error:', error);
      alert('Something went wrong!');
    }
  });
</script>

      <!-- <script>
        let excelData = [];

        document.getElementById('fileInput').addEventListener('change', (event) => {
          const file = event.target.files[0];
          const reader = new FileReader();

          reader.onload = (e) => {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });

            const sheetName = workbook.SheetNames[0];
            if (!sheetName) {
              document.getElementById('fileStatus').innerText = 'No sheets found in Excel file.';
              return;
            }

            const worksheet = workbook.Sheets[sheetName];
            excelData = XLSX.utils.sheet_to_json(worksheet);

            if (excelData.length > 0) {
              document.getElementById('fileStatus').innerText = `${excelData.length} records ready to upload`;
              document.getElementById('uploadBtn').style.display = 'inline-block';
            } else {
              document.getElementById('fileStatus').innerText = 'No records found in the Excel sheet.';
            }
          };

          reader.readAsArrayBuffer(file);
        });

        document.getElementById('uploadBtn').addEventListener('click', async () => {
          const fileInput = document.getElementById('fileInput');
          const file = fileInput.files[0];

          if (!file) {
            alert('Please select a file!');
            return;
          }

          const formData = new FormData();
          formData.append('file', file);

          try {
            const response = await fetch('http://localhost:8080/bulk-upload', {
              method: 'POST',
              body: formData, // DO NOT SET Content-Type manually; browser handles it
            });

            if (response.ok) {
              alert('File uploaded successfully!');
            } else {
              alert('File upload failed!');
            }
          } catch (error) {
            console.error('Upload error:', error);
            alert('Something went wrong!');
          }
        });

      </script> -->
    </div>

    <!-- <script>
    document.getElementById("insuranceForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      fetch("http://localhost:8080/post", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      })
        .then((response) => response.text())
        .then((msg) => alert(msg))
        .catch((error) => console.error("Submission failed:", error));
    });

    function downloadAll() {
      window.location.href = "http://localhost:8080/download";
    }

    function downloadById() {
      const id = document.getElementById("insuranceId").value;
      if (!id) {
        alert("Please enter an Insurance ID.");
        return;
      }
      window.location.href = `http://localhost:8080/loadbyid/${id}`;
    }
  </script> -->
    <script>
      document.getElementById("insuranceForm").addEventListener("submit", function (e) {
        e.preventDefault();

        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());

        // Convert boolean-like fields from string to actual booleans
        const booleanFields = [
          "priorityCustomer",
          "sensitiveCustomer",
          "policyHolderAlsoMember",
          "politicallyExposedPerson",
          "form60",
          "isMobileSameAsWhatsapp",
          "mailingSameAsPrimary",
        ];

        booleanFields.forEach((field) => {
          if (data[field] === "Yes") {
            data[field] = true;
          } else if (data[field] === "No") {
            data[field] = false;
          } else {
            data[field] = null; // or false, depending on how you want to handle empty values
          }
        });
        console.log(data); // Log the data to see the structure before sending
        // Send the data to the backend
        fetch("http://localhost:8080/post", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => response.text())
          .then((msg) => alert(msg))
          .catch((error) => console.error("Submission failed:", error));
      });

      function downloadAll() {
        window.location.href = "http://localhost:8080/download";
      }

      function downloadById() {
        const id = document.getElementById("insuranceId").value;
        if (!id) {
          alert("Please enter an Insurance ID.");
          return;
        }
        window.location.href = `http://localhost:8080/loadbyid/${id}`;
      }
    </script>

</body>

</html>